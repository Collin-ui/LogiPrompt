<!DOCTYPE html>
<html lang="de">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>LogiPrompt v2.3</title>
<style>
    body {
        margin: 0;
        font-family: 'Arial', sans-serif;
        background-color: #f0f8ff;
        color: #333;
    }
    header {
        background-color: #0077cc;
        color: white;
        padding: 1rem;
        text-align: center;
        font-size: 1.5rem;
        font-weight: bold;
    }
    #container {
        display: flex;
        min-height: 90vh;
    }
    nav {
        width: 220px;
        background-color: #e6f2ff;
        padding: 1rem;
        box-shadow: 2px 0 5px rgba(0,0,0,0.1);
    }
    nav ul {
        list-style: none;
        padding: 0;
    }
    nav li {
        padding: 0.8rem;
        margin-bottom: 0.5rem;
        background-color: #d0e7ff;
        border-radius: 5px;
        cursor: pointer;
        transition: 0.3s;
    }
    nav li:hover {
        background-color: #a6d1ff;
    }
    main {
        flex: 1;
        padding: 2rem;
    }
    .hidden {
        display: none;
    }
    input, select, textarea, button {
        display: block;
        margin-bottom: 1rem;
        padding: 0.5rem;
        width: 100%;
        font-size: 1rem;
    }
    button {
        background-color: #0077cc;
        color: white;
        border: none;
        border-radius: 5px;
        cursor: pointer;
    }
    button:hover {
        background-color: #005fa3;
    }
    .tooltip {
        display: inline-block;
        position: relative;
        cursor: pointer;
        color: #0077cc;
        font-weight: bold;
    }
    .tooltip .tooltiptext {
        visibility: hidden;
        width: 200px;
        background-color: #0077cc;
        color: #fff;
        text-align: center;
        border-radius: 5px;
        padding: 0.5rem;
        position: absolute;
        z-index: 1;
        bottom: 125%;
        left: 50%;
        margin-left: -100px;
        opacity: 0;
        transition: opacity 0.3s;
    }
    .tooltip:hover .tooltiptext {
        visibility: visible;
        opacity: 1;
    }
    #promptOutput {
        background-color: #f5f5f5;
        padding: 1rem;
        border-radius: 5px;
        margin-top: 1rem;
        min-height: 80px;
        white-space: pre-wrap;
    }
    #rating {
        display: flex;
        margin-top: 1rem;
        gap: 5px;
    }
    .box {
        width: 30px;
        height: 30px;
        border: 1px solid #ccc;
        border-radius: 3px;
        background-color: #eee;
    }
    .active {
        background-color: #00cc44;
    }
    .status {
        margin-top: 1rem;
        color: #0077cc;
        font-weight: bold;
    }
    #truckAnimation {
        width: 50px;
        height: 50px;
        margin: 1rem 0;
        transition: transform 2s ease-in-out;
    }
</style>
</head>
<body>
<header>LogiPrompt v2.3</header>
<div id="container">
    <nav>
        <ul>
            <li onclick="showPage('profile')">Profil</li>
            <li onclick="showPage('prompt')">Prompt Erstellung</li>
            <li onclick="showPage('favorites')">Favoriten</li>
        </ul>
    </nav>
    <main>
        <!-- Anmelde-/Registrierungsseite -->
        <div id="loginPage">
            <h2>Anmeldung / Registrierung</h2>
            <input type="text" id="name" placeholder="Name">
            <input type="text" id="role" placeholder="Rolle in der Firma">
            <input type="text" id="company" placeholder="Firmenname">
            <input type="password" id="password" placeholder="Passwort">
            <label><input type="checkbox" id="stayLoggedIn"> Angemeldet bleiben</label>
            <button onclick="login()">Anmelden</button>
        </div>

        <!-- Profilseite -->
        <div id="profilePage" class="hidden">
            <h2>Profil</h2>
            <input type="text" id="profileName" placeholder="Name">
            <input type="text" id="profileRole" placeholder="Rolle in der Firma">
            <input type="text" id="profileCompany" placeholder="Firmenname">
            <input type="file" id="profilePic">
            <button onclick="saveProfile()">Profil speichern</button>
            <div class="status" id="profileStatus"></div>
        </div>

        <!-- Prompt-Erstellung -->
        <div id="promptPage" class="hidden">
            <h2>Prompt Erstellung</h2>

            <label class="tooltip">i
                <span class="tooltiptext">Gib das Thema des Prompts ein (z.B. Ermahnung)</span>
            </label>
            <input type="text" id="keyword" placeholder="Thema / Schlüsselwort" required>

            <label class="tooltip">i
                <span class="tooltiptext">Rolle des Adressaten auswählen</span>
            </label>
            <select id="recipientRole">
                <option value="Fahrerpersonal">Fahrerpersonal</option>
                <option value="Logistikleitung">Logistikleitung</option>
                <option value="Disponent">Disponent</option>
            </select>

            <label class="tooltip">i
                <span class="tooltiptext">Name des Empfängers</span>
            </label>
            <input type="text" id="recipientName" placeholder="Empfänger Name">

            <label class="tooltip">i
                <span class="tooltiptext">Tonfall auswählen</span>
            </label>
            <select id="tone">
                <option value="ernst">Ernst</option>
                <option value="lösungsorientiert">Lösungsorientiert</option>
                <option value="freundlich">Freundlich</option>
            </select>

            <label class="tooltip">i
                <span class="tooltiptext">Textformat auswählen</span>
            </label>
            <select id="textFormat">
                <option value="Email">Email</option>
                <option value="Brief">Brief</option>
                <option value="Memo">Memo</option>
            </select>

            <label class="tooltip">i
                <span class="tooltiptext">Sprache auswählen</span>
            </label>
            <select id="language">
                <option value="Deutsch">Deutsch</option>
                <option value="Englisch">Englisch</option>
                <option value="Französisch">Französisch</option>
            </select>

            <button onclick="generatePrompt()">Prompt generieren</button>
            <button onclick="resetFields()">Zurücksetzen</button>

            <img id="truckAnimation" src="https://cdn-icons-png.flaticon.com/512/616/616408.png" style="transform: translateX(0);">

            <div id="promptOutput"></div>
            <button onclick="copyPrompt()">Prompt kopieren</button>
            <button onclick="saveFavorite()">Zu Favoriten hinzufügen</button>
            <div class="status" id="promptStatus"></div>

            <div id="rating">
                <div class="box" id="box1"></div>
                <div class="box" id="box2"></div>
                <div class="box" id="box3"></div>
                <div class="box" id="box4"></div>
                <div class="box" id="box5"></div>
            </div>
        </div>

        <!-- Favoriten -->
        <div id="favoritesPage" class="hidden">
            <h2>Favoriten</h2>
            <div id="favoritesList"></div>
        </div>
    </main>
</div>

<script>
let currentUser = null;

// Navigation
function showPage(page) {
    document.getElementById('loginPage').classList.add('hidden');
    document.getElementById('profilePage').classList.add('hidden');
    document.getElementById('promptPage').classList.add('hidden');
    document.getElementById('favoritesPage').classList.add('hidden');
    if(page === 'profile') document.getElementById('profilePage').classList.remove('hidden');
    if(page === 'prompt') document.getElementById('promptPage').classList.remove('hidden');
    if(page === 'favorites') {
        document.getElementById('favoritesPage').classList.remove('hidden');
        renderFavorites();
    }
}

// Login / Registrierung
function login() {
    const name = document.getElementById('name').value;
    const role = document.getElementById('role').value;
    const company = document.getElementById('company').value;
    const password = document.getElementById('password').value;

    if(!name || !role || !company || !password) {
        alert("Bitte alle Felder ausfüllen!");
        return;
    }

    currentUser = {name, role, company, password};
    localStorage.setItem('currentUser', JSON.stringify(currentUser));
    if(document.getElementById('stayLoggedIn').checked) {
        localStorage.setItem('stayLoggedIn', 'true');
    } else {
        localStorage.removeItem('stayLoggedIn');
    }

    // Profil Felder befüllen
    document.getElementById('profileName').value = name;
    document.getElementById('profileRole').value = role;
    document.getElementById('profileCompany').value = company;

    showPage('prompt');
}

// Profil speichern
function saveProfile() {
    currentUser.name = document.getElementById('profileName').value;
    currentUser.role = document.getElementById('profileRole').value;
    currentUser.company = document.getElementById('profileCompany').value;

    const picFile = document.getElementById('profilePic').files[0];
    if(picFile) {
        const reader = new FileReader();
        reader.onload = function(e) {
            currentUser.profilePic = e.target.result;
            localStorage.setItem('currentUser', JSON.stringify(currentUser));
            document.getElementById('profileStatus').innerText = "Profil gespeichert!";
        };
        reader.readAsDataURL(picFile);
    } else {
        localStorage.setItem('currentUser', JSON.stringify(currentUser));
        document.getElementById('profileStatus').innerText = "Profil gespeichert!";
    }
}

// Prompt generieren
function generatePrompt() {
    const keyword = document.getElementById('keyword').value;
    const recipientRole = document.getElementById('recipientRole').value;
    const recipientName = document.getElementById('recipientName').value;
    const tone = document.getElementById('tone').value;
    const textFormat = document.getElementById('textFormat').value;
    const language = document.getElementById('language').value;

    if(!keyword) { alert("Thema ist Pflichtfeld!"); return; }

    // LKW Animation
    const truck = document.getElementById('truckAnimation');
    truck.style.transform = "translateX(400px)";
    setTimeout(() => truck.style.transform = "translateX(0px)", 2000);

    const prompt = `Von: ${currentUser.name}, ${currentUser.role}, ${currentUser.company}\nAn: ${recipientName} (${recipientRole})\nTonfall: ${tone}\nFormat: ${textFormat}\nSprache: ${language}\nThema: ${keyword}\n\nBitte ChatGPT verwenden, um folgenden Text zu erstellen.`;

    document.getElementById('promptOutput').innerText = prompt;
    document.getElementById('promptStatus').innerText = "Prompt generiert!";

    // Bewertung berechnen
    let filled = 0;
    [keyword, recipientRole, recipientName, tone, textFormat, language].forEach(f => { if(f) filled++; });
    for(let i=1;i<=5;i++){
        document.getElementById('box'+i).classList.remove('active');
        if(i <= Math.min(filled,5)) document.getElementById('box'+i).classList.add('active');
    }
}

// Felder zurücksetzen
function resetFields() {
    document.getElementById('keyword').value = '';
    document.getElementById('recipientRole').selectedIndex = 0;
    document.getElementById('recipientName').value = '';
    document.getElementById('tone').selectedIndex = 0;
    document.getElementById('textFormat').selectedIndex = 0;
    document.getElementById('language').selectedIndex = 0;
    document.getElementById('promptOutput').innerText = '';
    document.getElementById('promptStatus').innerText = '';
    for(let i=1;i<=5;i++) document.getElementById('box'+i).classList.remove('active');
}

// Prompt kopieren
function copyPrompt() {
    const text = document.getElementById('promptOutput').innerText;
    navigator.clipboard.writeText(text).then(()=> {
        document.getElementById('promptStatus').innerText = "Prompt kopiert!";
    });
}

// Favoriten speichern
function saveFavorite() {
    const promptText = document.getElementById('promptOutput').innerText;
    if(!promptText) return;
    let favorites = JSON.parse(localStorage.getItem('favorites') || "[]");
    favorites.push({prompt: promptText, date: new Date().toISOString()});
    localStorage.setItem('favorites', JSON.stringify(favorites));
    document.getElementById('promptStatus').innerText = "Favorit hinzugefügt!";
}

// Favoriten anzeigen
function renderFavorites() {
    const favorites = JSON.parse(localStorage.getItem('favorites') || "[]");
    const container = document.getElementById('favoritesList');
    container.innerHTML = '';
    favorites.slice().reverse().forEach((f,i)=>{
        const div = document.createElement('div');
        div.style.border = '1px solid #ccc';
        div.style.padding = '0.5rem';
        div.style.marginBottom = '0.5rem';
        div.innerHTML = `<pre>${f.prompt}</pre>
        <button onclick="removeFavorite(${favorites.length - 1 - i})">Entfernen</button>`;
        container.appendChild(div);
    });
}

// Favorit entfernen
function removeFavorite(index) {
    let favorites = JSON.parse(localStorage.getItem('favorites') || "[]");
    favorites.splice(index,1);
    localStorage.setItem('favorites', JSON.stringify(favorites));
    renderFavorites();
}

// Automatisch eingeloggt bleiben
window.onload = function() {
    if(localStorage.getItem('stayLoggedIn') && localStorage.getItem('currentUser')) {
        currentUser = JSON.parse(localStorage.getItem('currentUser'));
        document.getElementById('profileName').value = currentUser.name;
        document.getElementById('profileRole').value = currentUser.role;
        document.getElementById('profileCompany').value = currentUser.company;
        showPage('prompt');
    }
};
</script>
</body>
</html>
